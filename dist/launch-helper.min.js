!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var s=class{constructor(){this._element=document.getElementsByTagName("launch-helper")[0]}get element(){return this._element}get src(){const e=this._element.getAttribute("src");return"/"===e[0]?e.slice(1):e}get method(){return this._element.getAttribute("method")||"GET"}get xdApi(){return this._element.getAttribute("api")}get staticResource(){return this._element.getAttribute("res")}appendIframe(){this._removeIframe();const e=document.createElement("iframe");e.setAttribute("id","studio"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),this._element.appendChild(e)}_removeIframe(){const e=this._element.getElementsByTagName("iframe");for(const t of e)this._element.removeChild(t)}};var o=class{constructor(){window.manifest||(window.manifest={});const e=new s;this.xdApi=e.xdApi,this.staticResource=e.staticResource||window.location.origin}get manifest(){return window.manifest}set xdApi(e){window.manifest.xdApi=e}set staticResource(e){window.manifest.staticResource||(window.manifest.staticResource=e)}};var r=class{constructor(e){this.ica=e}createSession(){const e=window.citrix;try{e.receiver.setPath(`${manifest.staticResource}/external/HTML5Client`),e.receiver.createSession(null,this._sessionParams,this._sessionCreated.bind(this))}catch(e){console.error(e)}}get _sessionParams(){return{launchType:"embed",closeOptions:{showDisconnectAlert:!1},container:{type:"iframe",id:"studio"},preferences:{ui:{toolbar:{fileTransfer:!1,about:!1,lock:!1,disconnect:!1,logoff:!0,fullscreen:!1,multitouch:!1,switchApp:!1,preferences:!1},appSwitcher:{showTaskbar:!1}}}}}_sessionCreated(e){this._sessionCreatedConfig(e),this._startSession(e)}_startSession(e){const t={type:"json",value:"string"==typeof this.ica?JSON.parse(this.ica):this.ica};e.start(t)}_sessionCreatedConfig(e){e.addListener("onConnection",function(e){console.log("Event Received : "+e.type),console.log(e.data)}),e.addListener("onConnectionClosed",function(e){console.log("Event Received : "+e.type),console.log(e.data)}),e.addListener("onError",function(e){console.log("Event Received : "+e.type),console.log(e.data)}),e.addListener("onURLRedirection",function(e){console.log("Event Received : "+e.type),console.log(e.data)})}};var i=new class{get user(){return{customer:window.cwcCustomerId||this._customer||"studiopool",token:window.cwcBearerToken||this._bearerToken}}get _bearerToken(){}get _customer(){}};var c=new class{get url(){return`${this._xenDesktopApi}/${(new s).src}`}get _xenDesktopApi(){return manifest.xdApi.replace("[customer]",i.user.customer)}};var a=class{get icaAsync(){return this._fetchIcaJson().then(e=>e)}async _fetchIcaJson(){const e=(new s).method,t={method:e,headers:{Authorization:`CWSAuth bearer=${i.user.token}`,"content-type":"application/json"}};"post"===e.toLowerCase()&&(t.body=JSON.stringify({SessionId:window.cwcSessionId}));const n=await fetch(c.url,t);return await n.json()}};var l=class{constructor(e,t){this._url=e,this._callback=t}loadScript(){const e=document.createElement("script");e.type="text/javascript",e.src=this._url,e.onreadystatechange=this._callback,e.onload=this._callback,document.body.appendChild(e)}};window.launchHelper=function(){const e=new Promise(e=>{new l(`${(new o).manifest.staticResource}/CitrixHTML5SDK.js`,()=>{e()}).loadScript()}),t=(new a).icaAsync;Promise.all([e,t]).then(e=>{const t=e[1];(new s).appendIframe(),new r(t).createSession()}).catch(e=>{console.log(e)})}}]);
//# sourceMappingURL=launch-helper.min.js.map