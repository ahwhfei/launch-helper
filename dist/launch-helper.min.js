!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);let s=null;var o=function(){return s||(s=new class{constructor(){this._element=document.getElementsByTagName("launch-helper")[0],this._config=null}get element(){return this._element}get src(){const e=this._element.getAttribute("src")||this._config&&this._config.src;return"/"===e[0]?e.slice(1):e}get method(){return this._element.getAttribute("method")||this._config&&this._config.method||"GET"}get xdApi(){return this._element.getAttribute("api")||this._config&&this._config.api}get staticResource(){return this._element.getAttribute("res")||this._config&&this._config.res||window.location.origin}set config(e){this._config=e}appendIframe(){this._removeIframe();const e=document.createElement("iframe");e.setAttribute("id","studio"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),this._element.appendChild(e)}_removeIframe(){const e=this._element.getElementsByTagName("iframe");for(const t of e)this._element.removeChild(t)}})};var i=class{constructor(e,t){this.ica=e,this.handlers=t}createSession(){const e=window.citrix;try{return e.receiver.setPath(`${o().staticResource}/external/HTML5Client`),e.receiver.createSession(null,this._sessionParams,this._sessionCreated.bind(this)),{success:!0}}catch(e){return console.error(e),{success:!1,msg:"create receiver session failed"}}}get _sessionParams(){return{launchType:"embed",container:{id:"studio",type:"iframe"},bounds:{autoresize:!1,width:window.innerWidth,height:window.innerHeight-112},closeOptions:{type:"close",showDisconnectAlert:!1},preferences:{ui:{toolbar:{menubar:!0,clipboard:!0,fileTransfer:!0,about:!0,lock:!1,disconnect:!1,logoff:!0,fullscreen:!1,keyboard:!0,multitouch:!0,switchApp:!1,preferences:!0,gestureGuide:!0},hide:{urlredirection:!0,error:!1,ftu:!0},appSwitcher:{showTaskbar:!1,autoHide:!1,showIconsOnly:!1}}}}}_sessionCreated(e){this._sessionCreatedConfig(e),this._startSession(e)}_startSession(e){const t={type:"json",value:"string"==typeof this.ica?JSON.parse(this.ica):this.ica};e.start(t)}_sessionCreatedConfig(e){e.addListener("onConnection",function(t){switch(this.handlers&&this.handlers.connectionHandler&&"function"==typeof this.handlers.connectionHandler?this.handlers.connectionHandler(t):(console.log("Event Received : "+t.type),console.log(t.data)),t.data.state){case"sessionReady":e.changeResolution({autoresize:!0})}}.bind(this)),e.addListener("onConnectionClosed",function(e){this.handlers&&this.handlers.connectionClosedHandler&&"function"==typeof this.handlers.connectionClosedHandler?this.handlers.connectionClosedHandler(e):(console.log("Event Received : "+e.type),console.log(e.data))}.bind(this)),e.addListener("onError",function(e){this.handlers&&this.handlers.onErrorHandler&&"function"==typeof this.handlers.onErrorHandler?this.handlers.onErrorHandler(e):(console.log("Event Received : "+e.type),console.log(e.data))}.bind(this)),e.addListener("onURLRedirection",function(e){this.handlers&&this.handlers.onURLRedirectionHandler&&"function"==typeof this.handlers.onURLRedirectionHandler?this.handlers.onURLRedirectionHandler(e):(console.log("Event Received : "+e.type),console.log(e.data))}.bind(this))}};var r=new class{get user(){return{customer:window.cwcCustomerId||this._customer||"studiopool",token:window.cwcBearerToken||this._bearerToken}}get _bearerToken(){}get _customer(){}};var c=class{get url(){return`${this._xenDesktopApi}/${o().src}`}get _xenDesktopApi(){return o().xdApi.replace("[customer]",r.user.customer)}};var a=class{get icaAsync(){return this._fetchIcaJson().then(e=>e)}async _fetchIcaJson(){const e=o().method,t={method:e,headers:{Authorization:`CWSAuth bearer=${r.user.token}`,"content-type":"application/json"}};"post"===e.toLowerCase()&&(t.body=JSON.stringify({SessionId:window.cwcSessionId}));const n=await fetch((new c).url,t);return await n.json()}};var l,d,h=class{constructor(e,t){this._url=e,this._callback=t}loadScript(){const e=document.createElement("script");e.type="text/javascript",e.src=this._url,e.onreadystatechange=this._callback,e.onload=this._callback,document.body.appendChild(e)}};function u(e,t){o().config=t;const n=new Promise(e=>{new h(`${o().staticResource}/CitrixHTML5SDK.js`,()=>{e()}).loadScript()}),s=(new a).icaAsync;return Promise.all([n,s]).then(t=>{const n=t[1];o().appendIframe();const s=new i(n,e).createSession();return s.ica=n,s}).catch(e=>(console.log(e),{failed:!0,msg:"Failed at getting Ica Json file"}))}function f(e){return o().config=e,(new a).icaAsync}l=void 0,d=function(){return{launchHelper:u,getIca:f,getIca:f}},"function"==typeof define&&"object"==typeof n(1)?define([],d):l["launch-helper"]=d()},function(e,t){(function(t){e.exports=t}).call(this,{})}]);
//# sourceMappingURL=launch-helper.min.js.map